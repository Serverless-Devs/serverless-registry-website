<!DOCTYPE html>
<html lang="zxx">

<head>
    <!--====== Required meta tags ======-->
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!--====== Title ======-->
    <title> 包详情 - Serverless Registry - Serverless package management platform </title>
    <!--====== Bootstrap css ======-->
    <link rel="stylesheet" href="static/css/bootstrap.min.css">
    <!--=== Owl-Carousel ===-->
    <link rel="stylesheet" href="static/css/owl.carousel.min.css">
    <!--====== Magnific ======-->
    <link rel="stylesheet" href="static/css/magnific-popup.css">
    <!--===nice-select===-->
    <link rel="stylesheet" href="static/css/nice-select.css">
    <!--====== Animate CSS ======-->
    <link rel="stylesheet" href="static/css/animate.min.css">
    <!--====== Font Awesome ======-->
    <link rel="stylesheet" href="static/css/font-awesome.min.css">
    <!--=== Toltip ===-->
    <link rel="stylesheet" href="static/css/envato-preview.css">
    <!--====== Magnifiq popup======-->
    <link rel="stylesheet" href="static/css/magnific-popup.css">
    <!--====== Main Css ======-->
    <link rel="stylesheet" href="static/css/style.css">
    <!--====== Responsive Css ======-->
    <link rel="stylesheet" href="static/css/responsive.css">
    <!--====== Markdown ======-->
    <link rel="stylesheet" href="markdown-editor/lib/material-icons.css">
    <link rel="stylesheet" href="markdown-editor/lib/base16-light.css">
    <link rel="stylesheet" href="markdown-editor/codemirror/lib/codemirror.css">
    <link rel="stylesheet" href="markdown-editor/lib/default.css">
    <link rel="stylesheet" href="markdown-editor/lib/github-markdown.css">
    <link rel="stylesheet" href="markdown-editor/lib/spell-checker.min.css">
    <link rel="stylesheet" href="markdown-editor/lib/sweetalert.css">
    <style>
        .markdown-body ol {
            list-style-type: decimal;
        }

        .markdown-body ul {
            list-style-type: disc;
        }
    </style>
    <!--    <link rel="stylesheet" href="static/css/github-markdown.css">-->
    <!--    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/github-fork-ribbon-css/0.2.3/gh-fork-ribbon.min.css">-->

    <style>
        .download {
            margin-left: 20px;
            width: 120px;
            height: 34px;
            border: 1px solid rgba(4, 10, 41, 0.12);
            border-radius: 3px;
            color: white;
            line-height: 2.53;
            text-align: center;
            font-weight: 500;
            /*background: #fff;*/
        }

        img {
            max-width: 100%;
        }

        table {
            max-width: 100%;
        }
    </style>
</head>

<body>
<!--====== Preloader Start ======-->
<div id="preloader">
    <div class="loader-cubes">
        <div class="loader-cube1 loader-cube"></div>
        <div class="loader-cube2 loader-cube"></div>
        <div class="loader-cube4 loader-cube"></div>
        <div class="loader-cube3 loader-cube"></div>
    </div>
</div>
<!--====== Preloader End ======-->

<!--====== Header Part Start ======-->
<header class="header-one sticky-header">
    <div class="header-navigation" style="padding-top: 10px;padding-bottom: 7px">
        <div class="container-fluid d-flex align-items-center justify-content-between container-1470">
            <div class="header-left">
                <h1 href="index.html" style="color: black">Serverless Registry</h1>
            </div>
            <div class="header-right d-flex align-items-center justify-content-end">
                <div class="site-nav-menu">
                    <ul class="primary-menu">
                        <li>
                            <a class="nav-link" href="index.html">首页</a>
                        </li>
                        <li>
                            <a class="nav-link" href="special.html">专题</a>
                        </li>
                        <li>
                            <a class="nav-link" href="application.html">应用</a>
                        </li>
                        <li>
                            <a class="nav-link" href="component.html">组件</a>
                        </li>
                        <li>
                            <a class="nav-link" href="plugin.html">插件</a>
                        </li>
                        <li>
                            <a class="nav-link"
                               href="https://github.com/Serverless-Devs/Serverless-Devs/blob/master/spec/zh/0.0.2/serverless_registry_model/readme.md"
                               target="_blank">规范</a>
                        </li>
                        <li>
                            <a class="nav-link" href="faq.html">常见问题</a>
                        </li>
                    </ul>
                    <a href="#0" class="nav-close"><i class="fal fa-times"></i></a>
                </div>
                <div class="header-extra d-flex align-items-center">
                    <div class="search-widget">
                        <a href="#0" class="search-icon"><i class="fal fa-search"></i></a>

                        <div class="search-form">
                            <form action="search.html" method="GET">
                                <input type="search" placeholder="请输入要搜索的 Serverless Package 关键词" name="keyword">
                            </form>

                            <a href="#0" class="search-close"><i class="fal fa-times"></i></a>
                        </div>
                    </div>
                    <div class="offcanvas-widget d-none">
                        <div class="offcanvas-icon">
                            <span></span><span></span><span></span>
                        </div>
                    </div>
                    <div class="nav-toggler">
                        <span></span><span></span><span></span>
                    </div>
                </div>
            </div>
        </div>
    </div>
</header>
<!--====== Header Part End ======-->

<!--====== Banner Start ======-->
<section class="breadcrumb-area">
    <div class="container">
        <div class="content">
            <h2 class="breadd  wow fadeInUp" id="title"></h2>
            <ul class="breadcrumb-list  wow fadeInUp">
                <li><a href="index.html">首页 /</a></li>
                <li id="packagetype">包详情</li>
            </ul>
        </div>
    </div>
</section>
<!--====== Banner End ======-->

<section class="product-details">
    <div class="container">
        <div class="row">
            <div class="col-xl-8">
                <div class="detsils-box">
                    <div class="box-one">
                        <div class="thumb open-gallery  wow fadeInUp" id="desciption"></div>
                    </div>
                    <div id="app">

                    </div>
                    <div class="box-two">
                        <ul class="nav nav-pills mb-3" id="pills-tab" role="tablist">
                            <li class="nav-item" role="presentation">
                                <a class="nav-link active" id="pills-description-tab" data-toggle="pill"
                                   href="#pills-description" role="tab" aria-controls="pills-description"
                                   aria-selected="true">帮助</a>
                            </li>
                            <li class="nav-item" role="presentation">
                                <a class="nav-link" id="pills-additional-imformation-tab" data-toggle="pill"
                                   href="#pills-additional-imformation" role="tab"
                                   aria-controls="pills-additional-imformation" aria-selected="false" id="sectitle">服务与权限</a>
                            </li>
                            <li class="nav-item" role="presentation" id="websiteproject">
                            </li>
                        </ul>
                        <div class="tab-content" id="pills-tabContent">
                            <div class="tab-pane fade show active" id="pills-description" role="tabpanel"
                                 aria-labelledby="pills-description-tab">
                                <div class="content wow fadeInUp markdown-body" id="mddata" style=""></div>
                            </div>
                            <div class="tab-pane fade" id="pills-additional-imformation" role="tabpanel"
                                 aria-labelledby="pills-additional-imformation-tab">
                                <div id="serviceList" class="markdown-body"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-xl-4 col-lg-6">
                <div class="product-information-content  wow fadeInUp">
                    <div class="pi-content">
                        <img src="" alt="" id="usepic" width="200px">
                        <h4 id="usename"></h4>
                    </div>
                </div>
                <div class="product-information  wow fadeInUp">
                    <div class="left-box">
                        <p class="text">厂商支持:</p>
                    </div>
                    <div class="right-box" id="provider"></div>
                </div>
                <div class="product-information  wow fadeInUp">
                    <div class="left-box">
                        <p class="text">更新时间:</p>
                        <p class="text">最新版本:</p>
                    </div>
                    <div class="right-box">
                        <span id="rightupdatetime"></span>
                        <a href="" class="link version" id="rightlatestversion"></a>
                    </div>
                </div>
                <div class="product-information  wow fadeInUp">
                    <div class="left-box">
                        <p class="text">历史版本</p>
                    </div>
                    <div class="right-box" id="historyversion"></div>
                </div>
                <div class="product-information  wow fadeInUp">
                    <div class="left-box">
                        <p class="text">标签</p>
                    </div>
                    <div class="right-box" id="tagslist"></div>
                </div>
            </div>
        </div>
    </div>
</section>

<!--====== Footer Area START ======-->
<footer class="footer-area two">
    <div class="container">
        <div class="row justify-content-between">
            <div class="col-lg-4 col-md-6 wow fadeInUp" data-wow-delay="0.2s">
                <div class="footer-box one">
                    <div class="logo">
                        <h1 style="color: white">Serverless Registry</h1>
                    </div>
                    <p class="text">Serverless Registry 是 Serverless Devs 社区的衍生品，遵循 Serverless Devs Model 规范，为打造
                        Serverless 生态基础，繁荣 Serverless 开源生态而努力。正在为成为好用的 Serverless 领域的 NPM，Pypi ... 而努力。 </p>

                    <div class="social">
                        <a href="https://github.com/serverless-devs/serverless-devs"><i class="fab fa-github"></i></a>
                        <a href="https://gitee.com/serverless-devs/Serverless-Devs"><i class="fab fa-git"></i></a>
                        <a href="https://www.serverless-devs.com"><i class="fab fa-page4"></i></a>
                    </div>
                </div>
            </div>
            <div class="col-lg-2 col-md-6 wow fadeInUp" data-wow-delay="0.3s">
                <div class="footer-box two">
                    <h4 class="lasthead">相关资源</h4>
                    <div class="footer-list">
                        <ul>
                            <li><a href="about.html"> 关于我们 </a></li>
                            <li><a href="https://github.com/serverless-devs/serverless-devs"> Serverless Devs 仓库 </a>
                            </li>
                            <li><a href="https://github.com/Serverless-Devs/Serverless-Devs/blob/master/spec/readme.md">
                                SDM 规范文档 </a></li>
                            <li><a href="https://github.com/Serverless-Devs/Serverless-Devs/discussions"> Serverless
                                Devs 社区 </a></li>
                            <li>
                                <a href="https://github.com/Serverless-Devs/Serverless-Devs/blob/master/CONTRIBUTORS.md">
                                    贡献者列表 </a></li>
                        </ul>
                    </div>
                </div>
            </div>
            <div class="col-lg-2 col-md-6 wow fadeInUp" data-wow-delay="0.4s">
                <div class="footer-box three">
                    <h4 class="lasthead">钉钉交流群</h4>
                    <div class="footer-list">
                        <img src="https://serverless-article-picture.oss-cn-hangzhou.aliyuncs.com/1648814797378_20220401120637498673.png">
                    </div>
                </div>
            </div>
            <div class="col-lg-2 col-md-6 wow fadeInUp" data-wow-delay="0.5s">
                <div class="footer-box none">
                    <h4 class="lasthead">微信公众号</h4>
                    <div class="footer-list">
                        <img src="https://serverless-article-picture.oss-cn-hangzhou.aliyuncs.com/1648814758343_20220401120558862369.png">
                    </div>
                </div>
            </div>
        </div>
    </div>
</footer>
<div class="copyright two">
    <div class="container">
        <div class="row">
            <div class="col-12  wow fadeInUp text-center">
                <p class="text">Copyright &copy; 2022. Serverless Devs; By <a href="http://www.bluo.cn" target="_blank">Anycodes</a>
                </p>
            </div>
        </div>
    </div>
</div>
<div id="tempContent" hidden></div>
<!--====== Footer Area END ======-->

<!--====== Back to top start ======-->
<div class="back-to-top">
    <a href="#0"> <i class="fas fa-arrow-up"></i> </a>
</div>
<!--====== Back to top start ======-->

<!--====== Jquery ======-->
<script src="static/js/jquery-3.6.0.min.js"></script>
<!--====== Bootstrap ======-->
<script src="static/js/bootstrap.bundle.min.js"></script>
<!--=== Owl-Carousel ===-->
<script src="static/js/owl.carousel.min.js"></script>
<!--====== Nice Select ======-->
<script src="static/js/jquery.nice-select.min.js"></script>
<!--====== tooltip ======-->
<script src="static/js/envato-preview.js"></script>
<!--====== Magnific ======-->
<script src="static/js/jquery.magnific-popup.min.js"></script>
<!--====== Wow ======-->
<script src="static/js/wow.min.js"></script>
<!--====== Main JS ======-->
<script src="static/js/main.js"></script>
<!--====== markdown ======-->
<!--<script src="markdown/editormd.min.js"></script>-->
<!--<script src="markdown/marked.min.js"></script>-->
<!--<script src="markdown/prettify.min.js"></script>-->
<!--<script src="markdown/raphael.min.js"></script>-->
<!--<script src="markdown/underscore.min.js"></script>-->
<!--<script src="markdown/sequence-diagram.min.js"></script>-->
<!--<script src="markdown/flowchart.min.js"></script>-->
<!--<script src="markdown/jquery.flowchart.min.js"></script>-->
<script src="markdown-editor/lib/markdown-it.js"></script>
<script src="markdown-editor/lib/markdown-it-footnote.js"></script>
<script src="markdown-editor/lib/highlight.pack.js"></script>
<script src="markdown-editor/lib/emojify.js"></script>
<script src="markdown-editor/codemirror/lib/codemirror.js"></script>
<script src="markdown-editor/codemirror/overlay.js"></script>
<script src="markdown-editor/codemirror/xml/xml.js"></script>
<script src="markdown-editor/codemirror/markdown/markdown.js"></script>
<script src="markdown-editor/codemirror/gfm/gfm.js"></script>
<script src="markdown-editor/codemirror/javascript/javascript.js"></script>
<script src="markdown-editor/codemirror/css/css.js"></script>
<script src="markdown-editor/codemirror/htmlmixed/htmlmixed.js"></script>
<script src="markdown-editor/codemirror/lib/util/continuelist.js"></script>
<script src="markdown-editor/lib/spell-checker.min.js"></script>
<script src="markdown-editor/lib/rawinflate.js"></script>
<script src="markdown-editor/lib/rawdeflate.js"></script>
<script src="markdown-editor/lib/sweetalert.min.js"></script>
<script>

    function getQueryVariable(variable) {
        var query = window.location.search.substring(1);
        var vars = query.split("&");
        for (var i = 0; i < vars.length; i++) {
            var pair = vars[i].split("=");
            if (pair[0] == variable) {
                return pair[1];
            }
        }
        return (false);
    }

    function insertParam(key, value, sourceData = document.location.search.substr(1)) {
        key = escape(key);
        value = escape(value);
        var kvp = sourceData.split('&');
        if (kvp == '') {
            return '?' + key + '=' + value;
        } else {
            var i = kvp.length;
            var x;
            while (i--) {
                x = kvp[i].split('=');
                if (x[0] == key) {
                    x[1] = value;
                    kvp[i] = x.join('=');
                    break;
                }
            }
            if (i < 0) {
                kvp[kvp.length] = [key, value].join('=');
            }
            return kvp.join('&')
        }
    }

    function getDetail() {
        const xmlhttp = window.XMLHttpRequest ? new XMLHttpRequest() : new ActiveXObject("Microsoft.XMLHTTP");
        xmlhttp.open("POST", 'https://registry.devsapp.cn/package/content', false);
        xmlhttp.onreadystatechange = function () {
            if (xmlhttp.readyState == 4 && xmlhttp.status == 200) {
                let tempData = JSON.parse(xmlhttp.responseText).Response
                document.getElementById('title').innerHTML = `${tempData.name}
                <h4><i class="fas fa-calendar"></i> ${tempData.create.split("T")[0]} / V${tempData.version} <a href="https://registry.devsapp.cn/simple/${tempData.name}/zipball/${tempData.version}" style="float: right;" class="download"><i class="fas fa-download" >
                    下载 </i> </a></h4>`
                document.getElementById('packagetype').innerHTML = {
                    "component": "组件详情",
                    "application": "应用详情",
                    "plugin": "插件详情"
                }[tempData.type]
                document.getElementById('desciption').innerHTML = tempData.description
                document.getElementById('usepic').src = tempData.userInformation.avatar_url
                document.getElementById('usename').innerHTML = `<a href="${tempData.userInformation.html_url}" target="_blank">${tempData.userInformation.user}</a>`
                document.getElementById('rightupdatetime').innerHTML = tempData.create.split("T")[0]
                document.getElementById('rightlatestversion').innerHTML = tempData.version
                document.getElementById('rightlatestversion').href = `https://registry.devsapp.cn/simple/${tempData.name}/zipball/${tempData.version}`
                let tagsString = ''
                for (let i = 0; i < tempData.tags.length; i++) {
                    tagsString = tagsString + `<span> ${tempData.tags[i]}  </span><br>`
                }
                document.getElementById('tagslist').innerHTML = tagsString
                let providerString = ''
                let aliyun = false
                for (let i = 0; i < tempData.provider.length; i++) {
                    providerString = providerString + `<span> ${tempData.provider[i]}  </span><br>`
                    if (tempData.provider[i] == "阿里云") {
                        aliyun = true
                    }
                }
                document.getElementById('provider').innerHTML = providerString
                // 获取所有文本中的html标签
                let sourceContent = tempData.readme
                sourceContent = sourceContent.replace(/<equation>((.*?\n)*?.*?)<\/equation>/ig, function (a, b) {
                    return '<img src="http://latex.codecogs.com/png.latex?' + encodeURIComponent(b) + '" />';
                });

                const Alist = sourceContent.match(/\[.*?\]\(.*?\)/gm)
                for (let i = 0; i < Alist.length; i++) {
                    if (!Alist[i].includes("](http")) {
                        console.log(Alist[i])
                        try {
                            const tempStr = Alist[i].replace('](', `](${tempData.home.slice(-1) == '/' ? tempData.home : (tempData.home + "/")}blob/HEAD/`)
                            sourceContent = sourceContent.replaceAll(Alist[i], tempStr)
                        } catch (e) {

                        }

                    }
                }

                var md = markdownit({
                    html: true,
                    highlight: function (code, lang) {
                        // if (languageOverrides[lang]) lang = languageOverrides[lang];
                        if (lang && hljs.getLanguage(lang)) {
                            try {
                                return hljs.highlight(lang, code).value;
                            } catch (e) {
                            }
                        }
                        return '';
                    }
                }).use(markdownitFootnote);
                var out = document.getElementById('mddata');
                var old = out.cloneNode(true);
                out.innerHTML = md.render(sourceContent);
                emojify.run(out);
                // console.log()
                // const regList = sourceContent.match(/<.*?>.*?<\/.*?>|<a .*?>.*?<\/a>|<p .*?>.*?<\/p>/mg)
                // console.log(regList)
                // const regDict = {}
                // for (let i = 0; i < regList.length; i++) {
                //     const tempStr = `abcdefg-devs-${i}-devs-gfedcba`
                //     regDict[tempStr] = regList[i]
                //     sourceContent = sourceContent.replaceAll(regList[i], tempStr)
                // }
                // // console.log(sourceContent)
                // // const htmlwriter = new commonmark.HtmlRenderer({sourcepos: true});
                // // const reader = new commonmark.Parser();
                // // document.getElementById("mddata").innerHTML = sourceContent
                // editormd.markdownToHTML('tempContent', {
                //     markdown: sourceContent,//+ "\r\n" + $("#append-test").text(),
                //     // htmlDecode: "image",  // you can filter tags decode
                //     emoji: true,
                //     taskList: true,
                //     tex: true,  // 默认不解析
                //     flowChart: true,  // 默认不解析
                //     sequenceDiagram: true,  // 默认不解析
                // })
                // let tempHtml = document.getElementById('tempContent').innerHTML
                // for (let i = 0; i < Object.keys(regDict).length; i++) {
                //     tempHtml = tempHtml.replaceAll(Object.keys(regDict)[i], regDict[Object.keys(regDict)[i]])
                // }
                // document.getElementById("mddata").innerHTML = tempHtml

                // editormd.markdownToHTML('mddata', {
                //     markdown: sourceContent,//+ "\r\n" + $("#append-test").text(),
                //     htmlDecode: "on*",
                //     emoji: true,
                //     // taskList: true,
                //     // tex: true,  // 默认不解析
                //     // flowChart: true,  // 默认不解析
                //     // sequenceDiagram: true,  // 默认不解析
                // })
                //
                // editormd.previewing();//预览效果

                // const parsed = reader.parse(sourceContent)
                // document.getElementById("mddata").innerHTML = htmlwriter.render(parsed);

                let serviceString = ''
                const serviceKeys = Object.keys(tempData.service)
                for (let i = 0; i < serviceKeys.length; i++) {
                    serviceString = serviceString + `<li> ${serviceKeys[i]}: ${tempData.service[serviceKeys[i]].Authorities.join(', ')}</li>`
                }
                document.getElementById('serviceList').innerHTML = serviceString
                let websiteproject = ''
                if (tempData.home) {
                    websiteproject = `<a class="nav-link" id="pills-review-tab-new" target="_blank" href="${tempData.home}">项目网站</a>`
                } else {
                    websiteproject = `<a class="nav-link" id="pills-review-tab-new" style="pointer-events: none;"><s>项目网站</s></a>`
                }
                document.getElementById('websiteproject').innerHTML = websiteproject
                if (tempData.type == 'application') {
                    let tempString = ''
                    if (aliyun) {
                        tempString = `<li style="margin-top: 8px">途径2：基于阿里云 Serverless 应用中心: <a href="https://fcnext.console.aliyun.com/applications/create?template=${tempData.name}"><img src="https://img.alicdn.com/imgextra/i1/O1CN01w5RFbX1v45s8TIXPz_!!6000000006118-55-tps-95-28.svg" alt="Deploy with Severless Devs"></a></li>`
                    }
                    document.getElementById('app').innerHTML = `
<div class="box-one" style="margin-top: 20px">
                        <div id="quick"> <h4 style="margin-bottom: 10px">快速体验</h4><li>途径1：通过 <a href="https://docs.serverless-devs.com/serverless-devs/install" style="color: #404040">Serverless Devs 开发者工具</a>快速体验：<code>s init ${tempData.name}</code></li>${tempString}</div>
                    </div>
                   `
                }
            }
        }
        xmlhttp.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
        let data = `name=${getQueryVariable('name')}`
        xmlhttp.send(data);
    }

    function getHistoryVersions() {
        const xmlhttp = window.XMLHttpRequest ? new XMLHttpRequest() : new ActiveXObject("Microsoft.XMLHTTP");
        xmlhttp.open("GET", `https://registry.devsapp.cn/simple/${getQueryVariable('name')}/releases`, false);
        xmlhttp.onreadystatechange = function () {
            if (xmlhttp.readyState == 4 && xmlhttp.status == 200) {
                let tempData = JSON.parse(xmlhttp.responseText).Response
                let tempString = ''
                for (let i = 0; i < tempData.length; i++) {
                    tempString = tempString + `<a href="https://registry.devsapp.cn/simple/${getQueryVariable('name')}/zipball/${tempData[i].tag_name}" target="_blank" class="link"> V${tempData[i].tag_name} (${tempData[i].created_at.split("T")[0]}) </a><br>`
                }
                document.getElementById('historyversion').innerHTML = tempString
            }
        }
        xmlhttp.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
        xmlhttp.send();
    }

    getDetail()
    getHistoryVersions()

</script>
</body>

</html>